Done
- criterion of merging according dr/r -> added but rough
- need to take refinement into account -> for now, is not compatible
- adaptive time step for large scales ? -> there's none
- added timestep plot to identify problematic zones


To finish
- physically coherent initial setup
- finish implement+test cons2prim Newman & Hanlin
- complete setup gestion (copy phys file, sim name, etc.)
- rework zone id, including use of shock detection
- and more
- add normalization choice to setup
- rego into cell resolution:
-> determine some dr/r fraction acceptable + way to check it
- be able to change normalization of plots on the fly
-> continue electron distribution & radiation work -> postprocessing

ALE to smooth between lagrangian in cold relat speed flows and eulerian in hot slow flows??
-> criterion based on wave / sound speed ratio?
-> dump local dt?
-> should not work: you will be limited by sound speed in any case

Clean run_analysis of old functions
Update shock strength to Mach number of shock velocity in unshocked medium

FOCUS:
1. launch sims internal shocks
--> do we reproduce the analytics in planar symmetry?
start at the beginning of the shock
don't even need split/merge (at least for starters)
box size -> moving window (see BM method, but use density and not only pressure bcause cold shells)
u1 = 100, u4 = 200, density contrast ~1/4 (slowest is more dense)...
see Minu's notes for quantities to plot
/!\ add velocity before and after shells to avoid shock structures on the external sides as much as possible
for this compare with expected ram pressure of the CD in the lab frame
in spherical define starting radius
maybe test for highest Lorentz
start with few hundreds cells and then test for convergence
check if algo detectes very small rarefaction wave on the front/back of the shells
-> move the box depending on that
--> and now in spherical symmetry
2. electron distribution in the flow
-> shock detection
-> cooling regimes
3. lightcurves production
-> be careful of relativistic effects (highly relativistic shells)
-> good test case: BM profile


Todolist:
1. Cell resolution, numerics, and plotting
- find a way to fuse cells in the shocked nebula but not too much
- once we're only limited by cells at shocks, asks about adaptive timestep
- recheck N&H cons2prim and RC EoS
- add theoretical estimates (expected Rcd growth rate with time)
- choice of x, y normalization on plot function

2. Shocks and self-similarity
- debug .apply() method
-> will be useful in lots of cases: especially analyzing sims ran without it -> update zone id
- change shock strength to Mach number (of shock front in unshocked medium)
- if shocks not resolved, we may have 2 identified shock cells close to each other
-> important to take in account for the e- distribution
-> choose where to renew e- population where compression ratio is met?
-> rego over NS06, check the values for q (page 4 before section 5.) and related shock strength
--> maybe let's go over the more general case, compare with BM76
--> Gamma43 as function of "q" (downstream to shock ratio)

3. Emitted radiation
- write post-processing of sim
-> first using the gamma_min and gamma_max from GAMMA
-> from shock detection in our method
First only one power-law, then add before and after gamma_min & gamma_max + cooling regimes

4. Jets in GAMMA
- make a setup file -> kinda done but hard to check in 2D
- discussion with Frederic Daigne
- papiers Ayache Daigne, Lamberts Daigne pour comparer les approches
- question du reverse shock dans l'afterglow (diversité des lightcurves difficile à expliquer avec FS seulement)
-> parler de notre taf avec Minu
- variabilité de l'injection -> variabilité du profil de densité qui peut influencer le passage du RS
- faut vraiment les lightcurves ptn
- Uhm, Zhang 2012 -> checker le Uhm Beloborodov 2007 pour la méthode

5. Internal shocks: collision of two (cold) shells 
-> ask Minu
-> relative Lorentz factor, densities ratio, shell width, collision radius...
equal width in the lab frame is a good starting assumption
-> redo current test case in planar and spherical

Done (clear and update between meetings):
- add dr/r plots to check
- shock detection in post-processing 